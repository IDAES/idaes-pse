/*! Rappid v3.2.0 - HTML5 Diagramming Framework

Copyright (c) 2015 client IO

 2020-06-12 


This Source Code Form is subject to the terms of the Rappid License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(e,c,h){"use strict";c=c&&c.hasOwnProperty("default")?c.default:c;function r(r,n,o){if(o=o||{},void 0===r)throw new Error("The the dia.Paper is a mandatory option.");r.trigger("beforeexport",o);var e=h.V(r.svg).clone(),i=e.node,t=e.findOne("."+h.util.addClassNamePrefix("layers")),a=o.area||r.getContentArea(),s=o.preserveDimensions;s&&e.attr({width:s.width||a.width,height:s.height||a.height}),e.removeAttr("style").attr("viewBox",[a.x,a.y,a.width,a.height].join(" ")),t.removeAttr("transform"),!1!==o.useComputedStyles&&function(e,t){for(var r=Array.from(e.querySelectorAll("*")),n=Array.from(t.querySelectorAll("*")),o=e.ownerDocument,i=o.styleSheets.length,a=[],s=i-1;0<=s;s--)a[s]=o.styleSheets[s],o.styleSheets[s].disabled=!0;var l={};r.forEach(function(e,t){var r=window.getComputedStyle(e,null),n={};h.util.forIn(r,function(e){n[e]=r.getPropertyValue(e)}),l[t]=n}),i!=o.styleSheets.length&&a.forEach(function(e,t){o.styleSheets[t]=e});for(var u=0;u<i;u++)o.styleSheets[u].disabled=!1;var f={};r.forEach(function(e,t){var r=window.getComputedStyle(e,null),n=l[t],o={};h.util.forIn(r,function(e){isNaN(e)&&r.getPropertyValue(e)!==n[e]&&(o[e]=r.getPropertyValue(e))}),f[t]=o}),n.forEach(function(e,t){c(e).css(f[t])})}(r.svg,i);var l=o.stylesheet;function u(){var e=o.beforeSerialize;if("function"==typeof e){var t=e.call(r,i,r);t instanceof SVGElement&&(i=t)}n(function(e){return(new XMLSerializer).serializeToString(e).replace(/&nbsp;/g,"Â ")}(i))}if(h.util.isString(l)&&function(e,t){var r=e.ownerDocument.implementation.createDocument(null,"xml",null);h.V(e).prepend(h.V("style",{type:"text/css"},[r.createCDATASection(t)]))}(e.node,l),r.trigger("afterexport",o),o.convertImagesToDataUris){var f=e.find("image").map(p);c.when.apply(c,f).then(function(){return u()})}else u()}function p(r){var n=c.Deferred(),e=r.attr("xlink:href")||r.attr("href");return h.util.imageToDataUri(e,function(e,t){!e&&t&&r.attr("xlink:href",t),n.resolve()}),n.promise()}function n(e,t){var n=h.util.uniqueId("svg_output");r(e,function(e){var t=window.open("",n,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes"),r="data:image/svg+xml,"+encodeURIComponent(e);t.document.write('<img src="'+r+'" style="max-height:100%" />')},h.util.assign({convertImagesToDataUris:!0},t))}h.dia.Paper.prototype.toSVG=function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return r.apply(this,[this].concat(t))},h.dia.Paper.prototype.openAsSVG=function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return n.apply(this,[this].concat(t))},e.openAsSVG=n,e.toSVG=r}(this.joint.format=this.joint.format||{},$,joint);